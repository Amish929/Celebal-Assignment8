Task: Create a Linux/Windows self-hosted agent.

A self-hosted agent is a machine (Linux or Windows) that you set up and register with Azure DevOps to run your pipelines. You manage it instead of using Microsoft-hosted agents.


âœ… Prerequisites
A Windows machine or VM (physical machine, Azure VM, or local system)

.NET Framework 4.6+ installed

Access to https://dev.azure.com

Project Administrator permissions

A Personal Access Token (PAT) to authenticate the agent

âœ… Step 1: Go to Agent Pools
Open your browser â†’ Go to https://dev.azure.com

Select your organization and project

At the bottom-left, click âš™ï¸ Project Settings

Under Pipelines, click Agent pools

Click on the Default pool (or create a new one)

Click New agent

âœ… Step 2: Download the Windows Agent
In the pop-up, select:

Windows (x64) platform

Click Download

It will download a .zip file (e.g., vsts-agent-win-x64-3.229.1.zip)

âœ… Step 3: Extract the Agent
Create a folder like C:\azagent

Move the ZIP file there

Right-click the ZIP file â†’ Click Extract All

Extract contents into C:\azagent

âœ… Step 4: Generate a Personal Access Token (PAT)
Click on your User icon (top-right) â†’ Security

Click New Token

Set:

Name: AgentToken

Organization: Your org

Expiration: 30 or 90 days

Scopes: âœ… Check Agent Pools (Read & manage) and Read & execute build pipelines

Click Create and copy the token (save it somewhere safe temporarily)

âœ… Step 5: Configure the Agent
Open Command Prompt as Administrator

Navigate to your agent folder:cd C:\azagent

Run the configuration command:config.cmd

You'll be prompted to enter:

Server URL: https://dev.azure.com/your-org-name

Authentication: Type PAT

Personal Access Token: Paste the token you created

Agent Pool: Choose Default or your custom one

Agent Name: Any name like win-agent-01

Accept defaults for work folder

âœ… Step 6: Start the Agent as a Windows Service
   command: run.cmd

ğŸ§ª Step 7: Verify Itâ€™s Connected
Go to Azure DevOps â†’ Project Settings â†’ Agent Pools

Click your pool (e.g., Default)

âœ… Your agent should show Online


For Linux

ğŸ§¾ Prerequisites
A Linux VM or physical machine (can be an Ubuntu EC2 instance or Azure VM)

Internet access from that machine

Azure DevOps project


âœ… Step 1: Go to Azure DevOps â†’ Agent Pools
Open your Azure DevOps Project:
ğŸ‘‰ https://dev.azure.com

Click âš™ï¸ Project Settings (bottom-left)

Under Pipelines, click Agent pools

Click Default or create a new pool

Click New agent

âœ… Step 2: Choose Your OS and Download Agent
In the â€œAdd a new agentâ€ screen:

Select Linux (x64) (or Windows if you're doing it on a Windows system)

Copy the commands shown on the screen. For example:

For Linux:
mkdir myagent && cd myagent
curl -O https://vstsagentpackage.azureedge.net/agent/3.229.1/vsts-agent-linux-x64-3.229.1.tar.gz
tar zxvf vsts-agent-linux-x64-3.229.1.tar.gz
./config.sh

During ./config.sh, you will be asked:

Azure DevOps URL: https://dev.azure.com/YOUR_ORG_NAME

PAT (Personal Access Token): Generate it from Azure DevOps â†’ top-right â†’ User Icon â†’ Security â†’ New Token

âœ… Step 3: Configure the Agent
./config.sh

Youâ€™ll be prompted for:

Server URL: https://dev.azure.com/your-org

Authentication: Choose PAT

PAT: Paste it

Agent pool: Use Default or your custom pool

Agent name: Give it any name (e.g., linux-agent)

Accept defaults for work folder and run options

âœ… Step 4: Start the Agent: ./run.sh

âœ… Now your agent will start automatically with the system.

